<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · RossbyWaveSpectrum</title><meta name="title" content="Library · RossbyWaveSpectrum"/><meta property="og:title" content="Library · RossbyWaveSpectrum"/><meta property="twitter:title" content="Library · RossbyWaveSpectrum"/><meta name="description" content="Documentation for RossbyWaveSpectrum."/><meta property="og:description" content="Documentation for RossbyWaveSpectrum."/><meta property="twitter:description" content="Documentation for RossbyWaveSpectrum."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../theory/">RossbyWaveSpectrum</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../">Using the code</a></li><li class="is-active"><a class="tocitem" href>Library</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Post-processing-Filters"><span>Post-processing Filters</span></a></li><li><a class="tocitem" href="#Validation"><span>Validation</span></a></li><li><a class="tocitem" href="#Lower-level-utilities"><span>Lower level utilities</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jishnub/RossbyWaveSpectrum.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/master/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.radial_operators" href="#RossbyWaveSpectrum.radial_operators"><code>RossbyWaveSpectrum.radial_operators</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">radial_operators(nr, nℓ;
    r_in_frac = 0.6,
    r_out_frac = 0.985,
    ν = 5e11,
    trackingrate = :hanson2020,
    scalings = DefaultScalings,
    superadiabaticityparams = (;))</code></pre><p>Compute the Chebyshev-basis representation of radial operators such as derivatives and factors that appear in the differential equations. The positional arguments <code>nr</code> and <code>nℓ</code> specify the number of radial and latitudinal coefficients in the stream functions.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The number of coefficients in the factors are chosen adaptively, and are unrelated to the arguments <code>nr</code> and <code>nℓ</code>.</p></div></div><p><strong>Keyword arguments</strong></p><ul><li><code>r_in_frac</code>: inner boundary of the domain as a fraction of the solar radius</li><li><code>r_out_frac</code>: outer boundary of the domain as a fraction of the solar radius</li><li><code>ν</code>: coefficient of viscosity, in CGS units</li><li><code>trackingrate</code>: the tracking rate <code>Ω0</code>. This may either by a number, or one of   <code>:hanson2020</code> (corresponding to <code>453.1 nHz</code>),   <code>:carrington</code> (corresponding to <code>456 nHz</code>),   <code>:cutoff</code> (corresponding to the rotation rate at the equator at <code>r = r_out_frac * Rsun</code>), or   <code>:surface</code> (corresponding to the rotation rate at the equator at <code>r = Rsun</code>).</li><li><code>superadiabaticityparams</code>: <code>NamedTuple</code> of parameters used to choose the superadiabaticity model.   Values specified here are passed on to <a href="#RossbyWaveSpectrum.superadiabaticity"><code>superadiabaticity</code></a>, and these supersede the defaults in   that function. This is empty by default.</li><li><code>scalings</code>: scalings applied to the equations to improve the balancing of the matrices to be diagonalized.   Default values are <code>(; Wscaling = 1e1, Sscaling = 1e3, Weqglobalscaling = 1e-4, Seqglobalscaling = 1.0)</code>,   which should typically be good enough. The interpretation is that the fields that feature in the eigenvalue   problem are <code>(V, Wscaling * W, Sscaling * S)</code> and the equations for <code>W</code> and <code>S</code> are multiplied by <code>Weqglobalscaling</code>   and <code>Seqglobalscaling</code> respectively. Such scalings leave the eigenvalues unchanged.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L495-L529">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.RotMatrix" href="#RossbyWaveSpectrum.RotMatrix"><code>RossbyWaveSpectrum.RotMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RotMatrix(::Val{:matrix}, V_symmetric::Bool, rotation_profile::Symbol; operators, kw...)
RotMatrix(::Val{:spectrum}, V_symmetric::Bool, rotation_profile::Symbol; operators, kw...)</code></pre><p>Struct containing the spectral decomposition of the rotation profile and the vorticity profile associated with differential rotation in the Sun, along with information about the parity of the solutions that are sought and the function that is to be used to generate the matrices.</p><p>A <code>RotMatrix</code> <code>R</code> may be called with arguments as <code>R(args...; kwargs....)</code>.  If <code>R</code> was created using <code>Val(:matrix)</code>, this will return the matrix representation of the operator <code>A</code> that features in the eigenvalue problem <span>$A\mathbf{v}=(ω/Ω_0)B\mathbf{v}$</span>. These matrices are computed using the rotation profile that <code>R</code> is constructed with. On the other hand, if <code>R</code> was created using <code>Val(:spectrum)</code> as the first argument, this will return the filtered spectrum and eigenvectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L209-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.mass_matrix" href="#RossbyWaveSpectrum.mass_matrix"><code>RossbyWaveSpectrum.mass_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mass_matrix(m::Integer;
    operators,
    V_symmetric::Bool)</code></pre><p>Compute the mass matrix <span>$B$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1222-L1234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.mass_matrix!" href="#RossbyWaveSpectrum.mass_matrix!"><code>RossbyWaveSpectrum.mass_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mass_matrix!(B, m::Integer;
    operators,
    V_symmetric::Bool)</code></pre><p>Compute the mass matrix <span>$B$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>. This operates in-place on the pre-allocated matrix <code>B</code>, and overwrites it with the result. The matrix <code>B</code> may be allocated using <a href="#RossbyWaveSpectrum.allocate_mass_matrix"><code>allocate_mass_matrix</code></a>.</p><p>See <a href="#RossbyWaveSpectrum.mass_matrix"><code>mass_matrix</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1240-L1251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.uniform_rotation_matrix" href="#RossbyWaveSpectrum.uniform_rotation_matrix"><code>RossbyWaveSpectrum.uniform_rotation_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">uniform_rotation_matrix(m::Integer; operators, V_symmetric::Bool)</code></pre><p>Compute the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>, assuming that the Sun is rotating like a solid body. The matrix would therefore not contain any terms corresponding to differential rotation.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1294-L1306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.uniform_rotation_matrix!" href="#RossbyWaveSpectrum.uniform_rotation_matrix!"><code>RossbyWaveSpectrum.uniform_rotation_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">uniform_rotation_matrix!(A, m::Integer; operators, V_symmetric::Bool)</code></pre><p>Compute the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>, assuming that the Sun is rotating like a solid body. This operates in-place on the pre-allocated matrix <code>A</code>, and overwrites it with the output. The matrix <code>A</code> may be allocated using <a href="#RossbyWaveSpectrum.allocate_operator_matrix"><code>allocate_operator_matrix</code></a>.</p><p>See <a href="#RossbyWaveSpectrum.uniform_rotation_matrix"><code>uniform_rotation_matrix</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1313-L1323">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.differential_rotation_matrix" href="#RossbyWaveSpectrum.differential_rotation_matrix"><code>RossbyWaveSpectrum.differential_rotation_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">differential_rotation_matrix(m::Integer;
    operators, rotation_profile::Symbol, V_symmetric::Bool, kw...)</code></pre><p>Return the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specified azimuthal order <code>m</code>, assuming a differentially rotating model of the Sun. The profile of rotation may be specified using the keyword argument <code>rotation_profile</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>rotation_profile</code>: label to select the rotation profile used to compute the spectrum.   See <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a> for the list of possible options.</li></ul><p>Additional keyword arguments will be passed on to the specific functions populating the matrix elements, such as <a href="#RossbyWaveSpectrum.solar_differential_rotation_terms!"><code>solar_differential_rotation_terms!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1935-L1954">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.differential_rotation_matrix!" href="#RossbyWaveSpectrum.differential_rotation_matrix!"><code>RossbyWaveSpectrum.differential_rotation_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">differential_rotation_matrix!(A, m::Integer;
    operators, rotation_profile::Symbol, V_symmetric::Bool, kw...)</code></pre><p>Compute the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specified azimuthal order <code>m</code> assuming a differentially rotating model of the Sun, and store the result in <code>A</code> (which will be overwritten).</p><p>See <a href="#RossbyWaveSpectrum.differential_rotation_matrix"><code>differential_rotation_matrix</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1964-L1974">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.uniform_rotation_spectrum" href="#RossbyWaveSpectrum.uniform_rotation_spectrum"><code>RossbyWaveSpectrum.uniform_rotation_spectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">uniform_rotation_spectrum(m::Integer; operators, V_symmetric::Bool)</code></pre><p>Compute the inertial-mode spectrum for the specified azimuthal order <code>m</code>, assuming that the Sun is rotating like a solid body, and it is being tracked from a frame that is rotating at the same rate as the Sun. This solves the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> and returns <code>(ω_over_Ω0, v, (A,B))</code>, where <code>ω_over_Ω0</code> is a vector of eigenvalues, and <code>v</code> is a matrix whose columns are the eigenvectors. <code>A</code> is computed internally by calling <a href="#RossbyWaveSpectrum.uniform_rotation_matrix!"><code>uniform_rotation_matrix!</code></a>, and <code>B</code> is computed by calling <a href="#RossbyWaveSpectrum.mass_matrix!"><code>mass_matrix!</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function returns all the eigenvalues and eigenfunctions without applying any filtering.</p></div></div><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>rotation_profile</code>: label to select the rotation profile used to compute the spectrum.   See <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a> for the list of possible options.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2113-L2132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.uniform_rotation_spectrum!" href="#RossbyWaveSpectrum.uniform_rotation_spectrum!"><code>RossbyWaveSpectrum.uniform_rotation_spectrum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">uniform_rotation_spectrum!((A, B), m::Integer; operators, V_symmetric::Bool)</code></pre><p>Compute the inertial-mode spectrum for the specified azimuthal order <code>m</code>, assuming that the Sun is rotating like a solid body, and it is being tracked from a frame that is rotating at the same rate as the Sun. This overwrites the pre-allocated pencil matrices <code>(A, B)</code>.</p><p>See <a href="#RossbyWaveSpectrum.uniform_rotation_spectrum"><code>uniform_rotation_spectrum</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2137-L2145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.differential_rotation_spectrum" href="#RossbyWaveSpectrum.differential_rotation_spectrum"><code>RossbyWaveSpectrum.differential_rotation_spectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">differential_rotation_spectrum(m::Integer; operators,
    V_symmetric::Bool, rotation_profile::Symbol, kw...)</code></pre><p>Compute the inertial-mode spectrum for the specified azimuthal order <code>m</code>, assuming that the Sun is rotating with a solar-like rotation profile (the exact model may be specified using <code>rotation_profile</code>), and it is being tracked in a frame rotating at a rate <code>Ω0 = operators.constants[:Ω0]</code>.</p><p>This solves the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> and returns <code>(ω_over_Ω0, v, (A,B))</code>, where <code>ω_over_Ω0</code> is a vector of eigenvalues, and <code>v</code> is a matrix whose columns are the eigenvectors. <code>A</code> is computed internally by calling <a href="#RossbyWaveSpectrum.differential_rotation_matrix!"><code>differential_rotation_matrix!</code></a>,  and <code>B</code> is computed by calling <a href="#RossbyWaveSpectrum.mass_matrix!"><code>mass_matrix!</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function returns all the eigenvalues and eigenfunctions without applying any filtering.</p></div></div><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>rotation_profile</code>: label to select the rotation profile used to compute the spectrum.   See <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a> for the list of possible options.</li></ul><p>Additional keyword arguments are forwarded to <a href="#RossbyWaveSpectrum.differential_rotation_spectrum!"><code>differential_rotation_spectrum!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2161-L2186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.differential_rotation_spectrum!" href="#RossbyWaveSpectrum.differential_rotation_spectrum!"><code>RossbyWaveSpectrum.differential_rotation_spectrum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">differential_rotation_spectrum!((A, B), m::Integer; operators,
    V_symmetric::Bool, rotation_profile::Symbol, kw...)</code></pre><p>Compute the inertial-mode spectrum for the specified azimuthal order <code>m</code>, assuming that the Sun is rotating with a solar-like rotation profile (the exact model may be specified using <code>rotation_profile</code>), and it is being tracked in a frame rotating at a rate <code>Ω0 = operators.constants[:Ω0]</code>. This overwrites the pre-allocated pencil matrices <code>(A, B)</code>.</p><p>See <a href="#RossbyWaveSpectrum.differential_rotation_spectrum"><code>differential_rotation_spectrum</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2194-L2204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.filter_eigenvalues" href="#RossbyWaveSpectrum.filter_eigenvalues"><code>RossbyWaveSpectrum.filter_eigenvalues</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filter_eigenvalues(ω_over_Ω0::AbstractVector{&lt;:Number},
    v::AbstractMatrix{&lt;:Number},
    (A,B), m::Integer;
    operators,
    V_symmetric::Bool,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators),
    filtercache = RossbyWaveSpectrum.allocate_filter_caches(m; operators, constraints),
    scale_eigenvectors::Bool = false,
    filterflags = RossbyWaveSpectrum.DefaultFilter,
    filterparams...)</code></pre><p>Filter the set of eigenvalue-eigenvector pairs <code>(ω_over_Ω0, v)</code> for a specified azimuthal order <code>m</code> to remove the potentially spurious ones. This returns a filtered set <code>(ω_over_Ω0f, vf)</code>. The eigenvalue pencil <code>(A,B)</code> should be provided if <code>Filters.EIGEN in filterflags</code>, and will be used in the filtering process. Otherwise, the parameters <code>(A,B)</code> are ignored.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>constraints</code>: boundary condition constraints on the spectral coefficients, optional</li><li><code>filtercache</code>: pre-allocated workspace used in the filtering process, optional</li><li><code>scale_eigenvectors</code>: flag to indices whether to compute the unscaled stream functions   from the scaled ones that are used in the eigenvalue problem.</li><li><code>filterflags</code>: the flags that specify which filters are used, optional.   See <a href="#RossbyWaveSpectrum.Filters"><code>Filters</code></a> for a list of possible flags.</li><li><code>filterparams</code>: additional filter parameters, passed on to <a href="#RossbyWaveSpectrum.filterfn"><code>filterfn</code></a>. See   <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the full list of parameters   that may be specified, and their default values.    The parameters specified in <code>filterparams</code> override the default values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2669-L2700">source</a></section><section><div><pre><code class="language-julia hljs">filter_eigenvalues(ω_over_Ω0s::AbstractVector{&lt;:AbstractVector{&lt;:Number}},
    vs::AbstractVector{&lt;:AbstractMatrix{&lt;:Number}},
    mr::AbstractVector{&lt;:Integer};
    matrixfn!,
    operators,
    V_symmetric::Bool,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators),
    filtercache = RossbyWaveSpectrum.allocate_filter_caches(m; operators, constraints),
    filterflags = RossbyWaveSpectrum.DefaultFilter,
    filterparams...)</code></pre><p>Filter the sets of eigenvalue-eigenvector pairs <code>(ω_over_Ω0, v)</code> for each azimuthal order <code>m</code> in the range <code>mr</code>, taken from the vectors <code>ω_over_Ω0s</code> and <code>vs</code>. The filtering operation for each <code>m</code> is independent of the others, and these are therefore carried out in parallel if multiple threads are available. This function returns a filtered set <code>(ω_over_Ω0sf, vsf)</code>, where <code>ω_over_Ω0sf[i]</code> and <code>vsf[i]</code> represents the filtered set of eigenvalues and eigenvectors corresponding to <code>m = mr[i]</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>matrixfn!</code>: The function used to compute the matrix <code>A</code> in the eigenvalue pencil <code>(A,B)</code>. This may be one of <a href="#RossbyWaveSpectrum.uniform_rotation_matrix!"><code>uniform_rotation_matrix!</code></a> or <a href="#RossbyWaveSpectrum.differential_rotation_matrix!"><code>differential_rotation_matrix!</code></a> or a <a href="#RossbyWaveSpectrum.RotMatrix"><code>RotMatrix</code></a>, and will be called as <code>matrixfn!(A, m; kw...)</code> to populate the matrix <code>A</code>.</li><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>constraints</code>: Boundary condition constraints on the spectral coefficients, optional</li><li><code>filtercache</code>: Pre-allocated workspace used in the filtering process, optional</li><li><code>filterflags</code>: The flags that specify which filters are used, optional.   See <a href="#RossbyWaveSpectrum.Filters"><code>Filters</code></a> for a list of possible flags.</li><li><code>filterparams</code>: additional filter parameters, passed on to <a href="#RossbyWaveSpectrum.filterfn"><code>filterfn</code></a>. See   <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the full list of parameters   that may be specified.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2758-L2790">source</a></section><section><div><pre><code class="language-julia hljs">filter_eigenvalues(spectrumfn!,
    mr::AbstractVector;
    operators,
    V_symmetric,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators),
    filtercache = RossbyWaveSpectrum.allocate_filter_caches(m; operators, constraints),
    filterflags = RossbyWaveSpectrum.DefaultFilter,
    filterparams...)</code></pre><p>Compute the spectrum of inertial waves for the specified range of azimuthal orders <code>mr</code>, and filter the solutions to remove potentially spurious solutions. This function returns <code>(ω_over_Ω0s, vs)</code>, where <code>ω_over_Ω0s[i]</code> and <code>vs[i]</code> represent the filtered set of eigenvalues and eigenvectors corresponding to <code>m = mr[i]</code>.</p><p>The argument <code>spectrumfn!</code> must be one of <a href="#RossbyWaveSpectrum.uniform_rotation_spectrum!"><code>uniform_rotation_spectrum!</code></a> or <a href="#RossbyWaveSpectrum.differential_rotation_spectrum!"><code>differential_rotation_spectrum!</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>constraints</code>: Boundary condition constraints on the spectral coefficients, optional</li><li><code>filtercache</code>: Pre-allocated workspace used in the filtering process, optional</li><li><code>filterflags</code>: The flags that specify which filters are used, optional.   See <a href="#RossbyWaveSpectrum.Filters"><code>Filters</code></a> for a list of possible flags.</li><li><code>filterparams</code>: additional filter parameters, passed on to <a href="#RossbyWaveSpectrum.filterfn"><code>filterfn</code></a>. See   <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the full list of parameters   that may be specified, and their default values.    The parameters specified in <code>filterparams</code> override the default values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2855-L2885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.save_eigenvalues" href="#RossbyWaveSpectrum.save_eigenvalues"><code>RossbyWaveSpectrum.save_eigenvalues</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save_eigenvalues(spectrumfn!, mr; operators, V_symmetric, rotation_profile, kw...)
save_eigenvalues(spectrumfn!::RotMatrix, mr; operators, kw...)</code></pre><p>Compute the spectra for all azimuthal orders <code>m in mr</code> using the function <code>spectrumfn!</code>, and save the results to disk, with a filename given by <a href="#RossbyWaveSpectrum.rossbyeigenfilename"><code>rossbyeigenfilename</code></a> Additional keyword arguments are passed on to <code>filter_eigenvalues</code> and <code>rossbyeigenfilename</code>.</p><p>If <code>spectrumfn! isa RotMatrix</code>, the keyword arguments <code>V_symmetric</code> and <code>rotation_profile</code> are automatically inferred from it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2969-L2979">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.FilteredEigen" href="#RossbyWaveSpectrum.FilteredEigen"><code>RossbyWaveSpectrum.FilteredEigen</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredEigen</code></pre><p>Struct to hold the filtered eigenvalues and eigenfunctions for a range of <code>m</code>. Given a <code>FilteredEigen</code> <code>F</code>, the eigenfunctions for a specific <code>m</code> may be obtained using <code>F[m]</code>, which returns a <a href="#RossbyWaveSpectrum.FilteredEigenSingleOrder"><code>FilteredEigenSingleOrder</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L74-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.FilteredEigen-Tuple{String}" href="#RossbyWaveSpectrum.FilteredEigen-Tuple{String}"><code>RossbyWaveSpectrum.FilteredEigen</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FilteredEigen(filename::AbstractString)</code></pre><p>Load the filtered eigenvalues and eigenvectors from <code>filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L105-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.datadir" href="#RossbyWaveSpectrum.datadir"><code>RossbyWaveSpectrum.datadir</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">datadir(filename)</code></pre><p>Preprend the data directory to the filename. This is a convenience function to make loading files less cumbersome.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L245-L250">source</a></section></article><h2 id="Post-processing-Filters"><a class="docs-heading-anchor" href="#Post-processing-Filters">Post-processing Filters</a><a id="Post-processing-Filters-1"></a><a class="docs-heading-anchor-permalink" href="#Post-processing-Filters" title="Permalink"></a></h2><h3 id="Filter-flags"><a class="docs-heading-anchor" href="#Filter-flags">Filter flags</a><a id="Filter-flags-1"></a><a class="docs-heading-anchor-permalink" href="#Filter-flags" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters" href="#RossbyWaveSpectrum.Filters"><code>RossbyWaveSpectrum.Filters</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">Filters</code></pre><p>Flags that may be passed to the <code>filterflags</code> keyword argument in <code>filter_eigenvalues</code> to specify which conditions to filter solutions by.</p><p>Possible options are:</p><ul><li><a href="#RossbyWaveSpectrum.Filters.NONE"><code>Filters.NONE</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.EIGEN"><code>Filters.EIGEN</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.EIGVAL"><code>Filters.EIGVAL</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.BC"><code>Filters.BC</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.SPATIAL_EQUATOR"><code>Filters.SPATIAL_EQUATOR</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.SPATIAL_RADIAL"><code>Filters.SPATIAL_RADIAL</code></a></li><li><a href="#RossbyWaveSpectrum.Filters.NODES"><code>Filters.NODES</code></a></li></ul><p>The individual filters may be combined using <code>|</code>, e.g. to include the <code>Filters.EIGEN</code> and the <code>Filters.SPATIAL_EQUATOR</code> flags, use <code>Filters.EIGEN | Filters.SPATIAL_EQUATOR</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2422-L2439">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.BC" href="#RossbyWaveSpectrum.Filters.BC"><code>RossbyWaveSpectrum.Filters.BC</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.BC</code></pre><p>Filter for eigenfunctions that satify the boundary conditions <span>$C\mathbf{v} = 0$</span>. Typically, all solutions should satisfy this condition, as this is imposed when solving the eigenvalue problem. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2487-L2494">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.DefaultFilter" href="#RossbyWaveSpectrum.Filters.DefaultFilter"><code>RossbyWaveSpectrum.Filters.DefaultFilter</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.DefaultFilter</code></pre><p>The default set of filter flags that are used to constrain the set of solutions. This is defined as</p><pre><code class="language-julia-repl hljs">julia&gt; Filters.DefaultFilter
(NODES | SPATIAL_RADIAL | SPATIAL_EQUATOR | BC | EIGVEC | EIGVAL | EIGEN)::RossbyWaveSpectrum.Filters.FilterFlag = 0x00df</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2532-L2541">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.EIGEN" href="#RossbyWaveSpectrum.Filters.EIGEN"><code>RossbyWaveSpectrum.Filters.EIGEN</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.EIGEN</code></pre><p>Filter for solutions <code>(ω, v)</code> that satisfy the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span>. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2461-L2466">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.EIGVAL" href="#RossbyWaveSpectrum.Filters.EIGVAL"><code>RossbyWaveSpectrum.Filters.EIGVAL</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.EIGVAL</code></pre><p>Filter for solutions that satisfy constraints on the eigenvalue, e.g. pick out damped solutions and ignore growing ones. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2469-L2475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.EIGVEC" href="#RossbyWaveSpectrum.Filters.EIGVEC"><code>RossbyWaveSpectrum.Filters.EIGVEC</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.EIGVAL</code></pre><p>Filter for smooth eigenfunctions, by applying spectral cutoffs in the Chebyshev order <code>n</code> as well as the spherical-harmonic degree <code>ℓ</code>. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2478-L2484">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.NODES" href="#RossbyWaveSpectrum.Filters.NODES"><code>RossbyWaveSpectrum.Filters.NODES</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.NODES</code></pre><p>Filter for eigenfunctions that have fewer than a specified number of radial nodes. A heuristic criteria is applied to ignore zero-crossings due to numerical or resolution limitations. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2514-L2520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.NONE" href="#RossbyWaveSpectrum.Filters.NONE"><code>RossbyWaveSpectrum.Filters.NONE</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.NONE</code></pre><p>Do not apply any filter. This retains all the solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2455-L2459">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.SPATIAL_EQUATOR" href="#RossbyWaveSpectrum.Filters.SPATIAL_EQUATOR"><code>RossbyWaveSpectrum.Filters.SPATIAL_EQUATOR</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.SPATIAL_EQUATOR</code></pre><p>Filter for eigenfunctions that latitudinally peak about the solar equator.     See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2497-L2502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.Filters.SPATIAL_RADIAL" href="#RossbyWaveSpectrum.Filters.SPATIAL_RADIAL"><code>RossbyWaveSpectrum.Filters.SPATIAL_RADIAL</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Filters.SPATIAL_RADIAL</code></pre><p>Filter for eigenfunctions where the power is not concentrated very close to the top and the bottom boundaries of the domain. See <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> for the parameters associated with this filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2505-L2511">source</a></section></article><h3 id="Filtering-functions"><a class="docs-heading-anchor" href="#Filtering-functions">Filtering functions</a><a id="Filtering-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.eigensystem_satisfy_filter" href="#RossbyWaveSpectrum.eigensystem_satisfy_filter"><code>RossbyWaveSpectrum.eigensystem_satisfy_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eigensystem_satisfy_filter(ω_over_Ω0::Number,
    v::StructVector{&lt;:Complex},
    (A,B)::NTuple{2,AbstractMatrix{&lt;:Number}},
    MVcache = RossbyWaveSpectrum.allocate_MVcache(size(A, 1));
    rtol = RossbyWaveSpectrum.DefaultFilterParams[:eigen_rtol])</code></pre><p>Return whether the eigenvalue <code>ω_over_Ω0</code> and eigenvector <code>v</code> satisfy <span>$A\mathbf{v}=(\omega/\Omega_0) B\mathbf{v}$</span> to within the relative tolerance <code>rtol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/eigensystem_satisfy_filter.jl#L45-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.eigvec_spectrum_filter" href="#RossbyWaveSpectrum.eigvec_spectrum_filter"><code>RossbyWaveSpectrum.eigvec_spectrum_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eigvec_spectrum_filter(v::AbstractVector{&lt;:Number}, m::Integer;
    operators,
    n_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:n_cutoff],
    Δl_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:Δl_cutoff],
    eigvec_spectrum_power_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:eigvec_spectrum_power_cutoff],
    filterfieldpowercutoff = RossbyWaveSpectrum.DefaultFilterParams[:filterfieldpowercutoff],
    low_n_power_lowercutoff = RossbyWaveSpectrum.DefaultFilterParams[:eigvec_spectrum_low_n_power_fraction_cutoff],
    kw...)</code></pre><p>Return if the eigenvector <code>v</code> is smooth enough, according to the specified criteria.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/eigvec_spectrum_filter.jl#L51-L62">source</a></section><section><div><pre><code class="language-julia hljs">eigvec_spectrum_filter(Feig::FilteredEigen, m::Integer, ind::Integer; kw...)</code></pre><p>Return if the eigenvector <code>ind</code>-th eigenvector of <code>Feig[m]</code> is smooth enough, according to the specified criteria. By default, the filter parameters are taken to be identical to those used to compute the solutions in <code>Feig</code>, but each of these parameters may be overridden.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/eigvec_spectrum_filter.jl#L69-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.spatial_filter" href="#RossbyWaveSpectrum.spatial_filter"><code>RossbyWaveSpectrum.spatial_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spatial_filter(v::AbstractVector{&lt;:Number}, m::Integer;
    operators,
    filtercache = RossbyWaveSpectrum.allocate_filter_caches(m; operators),
    θ_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:θ_cutoff],
    equator_power_cutoff_frac = RossbyWaveSpectrum.DefaultFilterParams[:equator_power_cutoff_frac],
    pole_cutoff_angle = RossbyWaveSpectrum.DefaultFilterParams[:pole_cutoff_angle],
    pole_power_cutoff_frac = RossbyWaveSpectrum.DefaultFilterParams[:pole_power_cutoff_frac],
    filterfieldpowercutoff = RossbyWaveSpectrum.DefaultFilterParams[:filterfieldpowercutoff],
    radial_topbotpower_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:radial_topbotpower_cutoff],
    kw...)</code></pre><p>Return if the eigenvector <code>v</code> for the azimuthal order <code>m</code> is spatially localized according to the specified parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/spatial_filter.jl#L129-L143">source</a></section><section><div><pre><code class="language-julia hljs">spatial_filter(Feig::FilteredEigen, m::Integer, ind::Integer; kw...)</code></pre><p>Return if the <code>ind</code>-th eigenvector of <code>Feig[m]</code> is spatially localized according to the specified parameters. By default, the filter parameters are taken to be identical to those used to compute the solutions in <code>Feig</code>, but each of these parameters may be overridden.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/spatial_filter.jl#L153-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.eigenvalue_filter" href="#RossbyWaveSpectrum.eigenvalue_filter"><code>RossbyWaveSpectrum.eigenvalue_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eigenvalue_filter(ω_over_Ω0, m;
    eig_imag_unstable_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:eig_imag_unstable_cutoff],
    eig_imag_to_real_ratio_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:eig_imag_to_real_ratio_cutoff],
    eig_imag_stable_cutoff = RossbyWaveSpectrum.DefaultFilterParams[:eig_imag_stable_cutoff])</code></pre><p>Return if the eigenvalue <code>ω_over_Ω0</code> represents a damped eigenfunction.</p><p><strong>Keyword arguments</strong></p><ul><li><code>eig_imag_unstable_cutoff</code>: lower cutoff below which modes are considered growing. This is slightly less than   zero to account for numerical errors.</li><li><code>eig_imag_to_real_ratio_cutoff</code>: cutoff ratio of linewidth to central frequency to filter out strongly damped modes.</li><li><code>eig_imag_stable_cutoff</code>: absolute cutoff on linewidth to filter out strongly damped modes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2216-L2229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.boundary_condition_filter" href="#RossbyWaveSpectrum.boundary_condition_filter"><code>RossbyWaveSpectrum.boundary_condition_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">boundary_condition_filter(v::StructVector{&lt;:Complex},
    BC::AbstractMatrix{&lt;:Real},
    BCVcache::StructVector{&lt;:Complex} = RossbyWaveSpectrum.allocate_BCcache(size(BC,1)),
    atol = 1e-5)</code></pre><p>Return if the eigenfunction with spectral coefficients <code>v</code> satisfies the boundary conditions within the absoute tolerance <code>atol</code>. The boundary-condition matrix <code>BC</code> may be obtained from <a href="#RossbyWaveSpectrum.constraintmatrix"><code>constraintmatrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2239-L2247">source</a></section></article><h2 id="Validation"><a class="docs-heading-anchor" href="#Validation">Validation</a><a id="Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Validation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.constant_differential_rotation_terms!" href="#RossbyWaveSpectrum.constant_differential_rotation_terms!"><code>RossbyWaveSpectrum.constant_differential_rotation_terms!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">constant_differential_rotation_terms!(A, m::Integer;
    operators,
    V_symmetric::Bool,
    ΔΩ_frac = 0.01)</code></pre><p>Compute the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>, assuming that the Sun is rotating like a solid body, albeit at a rotation speed <span>$Ω$</span> that exceeds the tracking rate <span>$Ω_0$</span> by the specified ratio <code>ΔΩ_frac</code> (i.e. <code>Ω = Ω0 * (1 + ΔΩ_frac)</code>). This function serves as a validation test for the differentially rotating model.</p><p>This function overwrites the input matrix <code>A</code> that is obtained as the output to <a href="#RossbyWaveSpectrum.uniform_rotation_matrix"><code>uniform_rotation_matrix</code></a>, and adds the extra terms corresponding to the difference in rotation rates to it.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>ΔΩ_frac</code>: Ratio by which the background rotation rate <span>$Ω$</span> exceeds the reference rate <span>$Ω_0$</span>.   The relation between the two is given by <code>Ω = Ω_0 * (1 + ΔΩ_frac)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1462-L1483">source</a></section></article><h2 id="Lower-level-utilities"><a class="docs-heading-anchor" href="#Lower-level-utilities">Lower level utilities</a><a id="Lower-level-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Lower-level-utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.DefaultFilterParams" href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">DefaultFilterParams</code></pre><p>Default list of parameters that are used in the filtering process. The full list is:</p><pre><code class="language-julia hljs">const DefaultFilterParams = Dict(
    # boundary condition filter: Filters.BC
    :bc_atol =&gt; 1e-5, # absolute tolerance to which boundary conditions must be satisfied
    # eigval filter: Filters.EIGVAL
    :eig_imag_unstable_cutoff =&gt; -1e-6, # absolute lower cutoff below which modes are considered to be exponentially growing
    :eig_imag_to_real_ratio_cutoff =&gt; 3, # relative upper cutoff on linewidths
    :eig_imag_stable_cutoff =&gt; 0.2, # absolute upper cutoff on linewidths
    # eigensystem satisfy filter: Filters.EIGEN
    :eigen_rtol =&gt; 0.01, # tolerance above which modes are rejected
    # smooth eigenvector filter: Filters.EIGVEC
    :Δl_cutoff =&gt; 7, # spherical harmonic degree
    :n_cutoff =&gt; 10, # chebyshev order
    :eigvec_spectrum_power_cutoff =&gt; 0.5, # fraction of total power required below cutoffs
    :eigvec_spectrum_low_n_power_fraction_cutoff =&gt; 1, # maximum ratio of total power above n_cutoff to total power below n_cutoff
    # spatial localization filter: Filters.SPATIAL
    :θ_cutoff =&gt; deg2rad(45), # colatitude below which a mode is considered equatorial
    :equator_power_cutoff_frac =&gt; 0.4, # minimum fraction of power that lie below θ_cutoff for equatorial modes
    :pole_cutoff_angle =&gt; deg2rad(25), # colatitude above which a mode is considered polar
    :pole_power_cutoff_frac =&gt; 0.05, # maximum fraction of power that may be near poles for equatorial modes
    :radial_topbotpower_cutoff =&gt; 0.7, # upper cutoff for power in the top and bottom 10% of the radial domain
    # radial nodes filter # Filters.NODES
    :nnodesmax =&gt; 5, # maximum number of radial nodes in either the real or imaginary component of the eigenfunction
    :nodessmallpowercutoff =&gt; 0.05, # minimum fractional power between roots beyond which a zero-crossing is considered real
    # exclude a field from filters if relative power is below a cutoff
    :filterfieldpowercutoff =&gt; 1e-2,
)</code></pre><p>Each parameter may be passed as a keyword argument to <a href="#RossbyWaveSpectrum.filter_eigenvalues"><code>filter_eigenvalues</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/DefaultFilterParams.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.filterfn" href="#RossbyWaveSpectrum.filterfn"><code>RossbyWaveSpectrum.filterfn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filterfn(λ::Number,
    v::AbstractVector{&lt;:Number},
    m::Integer,
    (A,B);
    operators,
    V_symmetric,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators),
    filtercache = RossbyWaveSpectrum.allocate_filter_caches(m; operators, constraints),
    filterflags = RossbyWaveSpectrum.DefaultFilter,
    filterparams...)</code></pre><p>Return whether one eigenvalue and eigenvector pair <code>(λ, v)</code> for the azimuthal order <code>m</code> satisfy the chosen filters. The matrices <code>(A,B)</code> represent the pencil.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a>.</li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>constraints</code>: boundary condition constraints on the spectral coefficients, optional.</li><li><code>filtercache</code>: pre-allocated workspace used in the filtering process, optional.</li><li><code>filterflags</code>: the flags that specify which filters are used, optional.   See <a href="#RossbyWaveSpectrum.Filters"><code>Filters</code></a> for a list of possible flags.</li><li><code>filterparams</code>: additional filter parameters to override the default ones   from <a href="#RossbyWaveSpectrum.DefaultFilterParams"><code>RossbyWaveSpectrum.DefaultFilterParams</code></a>.   The parameters specified in <code>filterparams</code> will override the default values,   and the ones left unspecified will be set to the default values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/filterfn.jl#L1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.solar_differential_rotation_terms!" href="#RossbyWaveSpectrum.solar_differential_rotation_terms!"><code>RossbyWaveSpectrum.solar_differential_rotation_terms!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solar_differential_rotation_terms!(A, m::Integer;
    operators,
    V_symmetric::Bool,
    rotation_profile::Symbol,
    ΔΩ_frac = 0.01, # only used to test the constant case
    ΔΩ_scale = 1, # scale the diff rot profile
    kw...)</code></pre><p>Compute the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> for a specific <code>m</code>, assuming that the Sun is rotating with a solar-like rotation profile. The keyword argument <code>rotation_profile</code> specifies the specific model that is chosen. Optionally, additional keyword arguments <code>kw</code> may be passed to alter the specifics of the model. These are detailed below.</p><p>This function overwrites the input matrix <code>A</code> that is obtained as the output to <a href="#RossbyWaveSpectrum.uniform_rotation_matrix"><code>uniform_rotation_matrix</code></a>, and adds the extra terms corresponding to differential rotation to it.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>rotation_profile</code>: label to select the rotation profile used to compute the spectrum.   See <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a> for the list of possible options.</li><li><code>ΔΩ_frac</code>: ratio by which the background rotation rate <span>$Ω$</span> exceeds the reference rate <span>$Ω_0$</span>, optional.   The relation between the two is given by <code>Ω = Ω_0 * (1 + ΔΩ_frac)</code>.   This is only used if <code>rotation_profile == :constant</code>, and is chosen to be <code>0.01</code> by default.</li><li><code>ΔΩ_scale</code>: factor by which the differential rotation profile may be scaled. This may be used to   tune the differential rotation to trace the results back to the solid-body rotation case.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1774-L1804">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid" href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solar_differential_rotation_profile_derivatives_grid(;
    operators,
    rotation_profile,
    ΔΩ_frac = 0.01,
    kw...)</code></pre><p>Return the smoothed spatial profile of rotation, corresponding to the model specified by <code>rotation_profile</code>. This function reads in rotation model files, and interpolates the profile on to Chebyshev nodes in both the radial and angular coordinates through smoothing splines. This spatial profile is subsequently transformed to spectral coefficients in <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_Fun"><code>solar_differential_rotation_profile_derivatives_Fun</code></a>.</p><p>Typically, this is used to load the solar rotation profile, but other profiles may be specified for testing the code.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <code>radial_operators</code></li><li><code>rotation_profile</code>: the flag that chooses the model of the rotation profile. Possible options are:<ul><li><code>:solar_latrad</code>: Smoothed solar rotation profile, limited to the radial domain</li><li><code>:solar_latrad_squished</code>: Same as <code>latrad</code>, except the solar surface is projected to the outer boundary of the radial domain.</li><li><code>:solar_radial_equator</code>: smoothed radial profile of the solar equatorial rotation rate, but limited to the radial domain. This corresponds to the radial profile of the <code>latrad</code> model at the equator.</li><li><code>:solar_radial_equator_squished</code>: same profile as <code>radial_equator</code>, except that the solar surface is projected onto the outer boundary of the radial domain. This corresponds to the radial profile of the <code>latrad_squished</code> model at the equator.</li><li><code>:solar_constant</code>: background medium rotates like a solid body, at a rate <code>Ω</code> that differs from the tracking rate <code>Ω0</code></li></ul></li><li><code>ΔΩ_frac</code>: In case <code>rotation_profile == :solar_constant</code>, the factor by which the tracking rate <code>Ω0</code> is increased   to obtain the rotation rate of the background medium.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1069-L1098">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_Fun" href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_Fun"><code>RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_Fun</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solar_differential_rotation_profile_derivatives_Fun(;
    operators,
    rotation_profile,
    ΔΩ_smoothing_param = 5e-2,
    kw...)</code></pre><p>Compute the Chebyshev-Ultraspherical decomposition of the rotation profile specified by <code>rotation_profile</code>, which typically is a smoothed version of the solar rotation profile. The keyword arguments <code>kw</code> are passed on to <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a>.</p><p>Returns a collection <code>(; ΔΩ, dr_ΔΩ, d2r_ΔΩ, dz_ΔΩ)</code>, where the first term is the spectral approximation to the profile of differential rotation, and the subsequent terms are radial and <code>z</code>-derivatives.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <code>radial_operators</code></li><li><code>rotation_profile</code>: the flag that chooses the model of the rotation profile.   See <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a> for possible options.</li><li><code>ΔΩ_smoothing_param</code>: the extent of smoothing applied to the rotation profile before performing the spectral   transform. Typically, this should be small to match the original profile closely, with the tradeoff   being in the number of spectral coefficients that are necessary to represent the model.</li><li><code>kw</code>: Optional keyword arguments that are passed on to <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_grid"><code>solar_differential_rotation_profile_derivatives_grid</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1143-L1165">source</a></section><section><div><pre><code class="language-julia hljs">solar_differential_rotation_profile_derivatives_Fun(Feig::FilteredEigen; kw...)</code></pre><p>Return the profile of background rotation that was used to compute the spectrum contained in <code>Feig</code>. Additional keyword arguments <code>kw</code> may be supplied to override the ones in <code>Feig</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1682-L1687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.solar_differential_rotation_vorticity_Fun" href="#RossbyWaveSpectrum.solar_differential_rotation_vorticity_Fun"><code>RossbyWaveSpectrum.solar_differential_rotation_vorticity_Fun</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solar_differential_rotation_vorticity_Fun(; operators, ΔΩprofile_deriv)</code></pre><p>Return the spectral approximation to the vorticity associated with differential rotation  <span>$\left(\boldsymbol{ω}_\Omega = ∇ × (Ω \hat{z})\right)$</span>, given the rotation profile <span>$Ω$</span> and its derivatives.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>ΔΩprofile_deriv</code>: Collection containing the rotation profile and its derivatives, obtained from   <a href="#RossbyWaveSpectrum.solar_differential_rotation_profile_derivatives_Fun"><code>solar_differential_rotation_profile_derivatives_Fun</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1692-L1703">source</a></section><section><div><pre><code class="language-julia hljs">solar_differential_rotation_vorticity_Fun(Feig::FilteredEigen; kw...)</code></pre><p>Return the profile of vorticity associated with background rotation that was used to compute the spectrum contained in <code>Feig</code>. Additional keyword arguments in <code>kw</code> may be used to override the ones in <code>Feig</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1762-L1768">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.constraintmatrix" href="#RossbyWaveSpectrum.constraintmatrix"><code>RossbyWaveSpectrum.constraintmatrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">constraintmatrix(operators)</code></pre><p>Return a collection containing the spectral representation of the boundary condition operator <code>BC</code>, and a basis <code>ZC</code> whose columns lie in its null-space. The <code>operators</code> may be obtained using <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a>.</p><p>The constraint satisfied by the eigenfunctions may be expressed as <span>$C\mathbf{v}=0$</span>. Given a matrix <span>$Z$</span> that satisfies <span>$CZ=0$</span>, we may express the eigenfunction as <span>$\mathbf{v}=Z\mathbf{w}$</span> for an arbitrary <span>$\mathbf{w}$</span>. This function uses the variable names <code>BC</code> for <span>$C$</span> and <code>ZC</code> for <span>$Z$</span>.</p><p>The matrices may be destructured as <code>(; BC, ZC) = RossbyWaveSpectrum.constraintmatrix(operators)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L291-L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.superadiabaticity" href="#RossbyWaveSpectrum.superadiabaticity"><code>RossbyWaveSpectrum.superadiabaticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">superadiabaticity(r::Real;
    r_out = Rsun,
    δcz = 3e-6,
    δtop = 3e-5,
    δrad = -1e-3,
    dtrans = 0.05Rsun,
    dtop = 0.05Rsun,
    r_sub = 0.8Rsun,
    r_tran = 0.725Rsun)</code></pre><p>Compute the superadiabaticity profile <span>$δ$</span> parameterized by the keyword arguments, following <a href="https://ui.adsabs.harvard.edu/abs/2005ApJ...622.1320R/abstract">Rempel (2005), ApJ 622:1320 –1332</a>, section 2.3.</p><p><strong>Keyword arguments</strong></p><ul><li><code>δcz</code>: representative value of superadiabaticity <span>$δ$</span> in the bulk of the convection zone</li><li><code>δtop</code>: representative value of superadiabaticity <span>$δ$</span> at the surface</li><li><code>δrad</code>: representative value of superadiabaticity <span>$δ$</span> in the radiative interior</li><li><code>dtrans</code>: scale over which the profile in the radiative zone transitions to that in the convection zone</li><li><code>dtop</code>: scale over which the profile in the convection zone transitions to that at the surface</li><li><code>r_tran</code>: radius below which the radiative profile transitions to strongly subadiabatic (in the overshoot region)</li><li><code>r_sub</code>: radius below which the radiative profile transitions to weakly subadiabatic within the convection zone</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L381-L404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.eigenfunction_realspace" href="#RossbyWaveSpectrum.eigenfunction_realspace"><code>RossbyWaveSpectrum.eigenfunction_realspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eigenfunction_realspace(v, m; operators, V_symmetric::Bool,
    n_lowpass_cutoff = nothing,
    Δl_lowpass_cutoff = nothing)</code></pre><p>Compute the real-space eigenfunctions from the spectral coefficients <code>v</code> for the azimuthal order <code>m</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>V_symmetric</code>: set to <code>true</code> or <code>false</code> depending on   whether the stream function <code>V</code> is latitudinally symmetric or antisymmtric about the equator.</li><li><code>n_lowpass_cutoff</code>: maximum chebyshev order <code>n</code> to retain in the inverse transform, optional.   If no value is provided, all the coefficients are used (default).</li><li><code>Δl_lowpass_cutoff</code>: maximum harmonic order <code>ℓ</code> to retain in the inverse transform, optional.   If no value is provided, all the coefficients are used (default).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L3169-L3184">source</a></section><section><div><pre><code class="language-julia hljs">eigenfunction_realspace(Feig::FilteredEigen, m, ind; kw...)</code></pre><p>Return the real-space eigenfunction from the <code>ind</code>-th eigenvector for the azimuthal order <code>m</code>, taken from the full list of solutions <code>Feig</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L3193-L3198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.compute_constrained_matrix" href="#RossbyWaveSpectrum.compute_constrained_matrix"><code>RossbyWaveSpectrum.compute_constrained_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_constrained_matrix(A, constraints)</code></pre><p>Compute the constrained matrix <span>$Z^T A Z$</span> given <code>A</code>. Here the columns of <code>Z = constraints.ZC</code> represents the spectral coefficients of a basis that satifies the boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2012-L2018">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.compute_constrained_matrix!" href="#RossbyWaveSpectrum.compute_constrained_matrix!"><code>RossbyWaveSpectrum.compute_constrained_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_constrained_matrix!(out, constraints, A)</code></pre><p>Compute the constrained matrix <span>$Z^T A Z$</span> given <code>A</code>, and overwrite <code>out</code> with the result. Here the columns of <code>Z = constraints.ZC</code> represents the spectral coefficients of a basis that satifies the boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1995-L2001">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.constrained_eigensystem" href="#RossbyWaveSpectrum.constrained_eigensystem"><code>RossbyWaveSpectrum.constrained_eigensystem</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">constrained_eigensystem((A, B);
    operators,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators),
    cache = RossbyWaveSpectrum.constrained_matmul_cache(constraints),
    temp_projectback = RossbyWaveSpectrum.allocate_projectback_temp_matrices(size(constraints.ZC)),
    kw...)</code></pre><p>Solve the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span> subject to the boundary-condition constraint <span>$C\mathbf{v}=0$</span>, and return <code>(λ, v, (A, B))</code>. The input arguments are the matrix pencil <code>(A, B)</code>.</p><p>Internally, this computes a matrix <code>Z = constraints.ZC</code> that represents the spectral coefficients of a basis that satifies the boundary conditions (i.e. this satisfies <span>$CZ=0$</span>). The eigenfunction <span>$\mathbf{v}$</span> may therefore be expressed as <span>$\mathbf{v} = Z\mathbf{w}$</span> for an arbitrary <span>$\mathbf{w}$</span>. Substituting this, and projecting the eigenvalue problem on to the basis <span>$Z$</span>, we obtain <span>$(Z^T A Z)\mathbf{w} = (\omega/\Omega_0)(Z^T B Z)\mathbf{w}$</span>, which is solved numerically. Finally, the eigenfunctions are transformed to the Chebyshev basis using <span>$\mathbf{v} = Z\mathbf{w}$</span>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>constraints</code>: projection matrices to enforce the boundary conditions, optional.</li><li><code>cache</code>: temporary arrays used in evaluating the constrained matrix pencil <code>(Z^T A Z, Z^T B Z)</code>, optional.   See <a href="#RossbyWaveSpectrum.constrained_matmul_cache"><code>constrained_matmul_cache</code></a></li><li><code>temp_projectback</code>: temporary arrays used in computing <code>v</code> from <code>w</code>, optional.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2063-L2089">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.constrained_matmul_cache" href="#RossbyWaveSpectrum.constrained_matmul_cache"><code>RossbyWaveSpectrum.constrained_matmul_cache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">constrained_matmul_cache(constraints)</code></pre><p>Allocate temporary matrices that are overwritten with <span>$Z^T A Z$</span> and <span>$Z^T B Z$</span>, given the eigenvalue pencil <span>$(A, B)$</span>, where the columns of <code>Z = constraints.ZC</code> represent the spectral coefficients of a basis that satifies the boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L1981-L1987">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_operator_matrix" href="#RossbyWaveSpectrum.allocate_operator_matrix"><code>RossbyWaveSpectrum.allocate_operator_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_operator_matrix(operators)</code></pre><p>Allocate the operator matrix <span>$A$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span>. The argument <code>operators</code> is obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This does not initialize the matrix.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L758-L767">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_mass_matrix" href="#RossbyWaveSpectrum.allocate_mass_matrix"><code>RossbyWaveSpectrum.allocate_mass_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_mass_matrix(operators)</code></pre><p>Allocate the mass matrix <span>$B$</span> that features in the eigenvalue problem <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span>. The argument <code>operators</code> is obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This does not initialize the matrix.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L777-L786">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_operator_mass_matrices" href="#RossbyWaveSpectrum.allocate_operator_mass_matrices"><code>RossbyWaveSpectrum.allocate_operator_mass_matrices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_operator_mass_matrices(operators)</code></pre><p>Allocate the eigenvalue pencil matrices <span>$(A,B)$</span>. The argument <code>operators</code> is obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This does not initialize the matrices.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L794-L802">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_filter_caches" href="#RossbyWaveSpectrum.allocate_filter_caches"><code>RossbyWaveSpectrum.allocate_filter_caches</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_filter_caches(m; operators,
    constraints = RossbyWaveSpectrum.constraintmatrix(operators))</code></pre><p>Allocate temporary matrices used in the filtering process, given the azimuthal order <code>m</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>operators</code>: obtained as the output of <a href="#RossbyWaveSpectrum.radial_operators"><code>radial_operators</code></a></li><li><code>constraints</code>: boundary condition constraints on the spectral coefficients, optional</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2592-L2601">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_projectback_temp_matrices" href="#RossbyWaveSpectrum.allocate_projectback_temp_matrices"><code>RossbyWaveSpectrum.allocate_projectback_temp_matrices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_projectback_temp_matrices(sz)</code></pre><p>Allocate temporary matrices used to project the eigenfunctions for <span>$(Z^T A Z)\mathbf{w} = (\omega/\Omega_0)(Z^T B Z)\mathbf{w}$</span> to those for <span>$A\mathbf{v}=(\omega/\Omega_0)B\mathbf{v}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2043-L2049">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.operator_matrices" href="#RossbyWaveSpectrum.operator_matrices"><code>RossbyWaveSpectrum.operator_matrices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_matrices(Feig::FilteredEigen, m; kw...)</code></pre><p>Return the pencil <code>(A, B)</code> for the azimuthal order <code>m</code>, using the parameters used to compute the eigenvalues in <code>Feig</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L3017-L3022">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.rossbyeigenfilename" href="#RossbyWaveSpectrum.rossbyeigenfilename"><code>RossbyWaveSpectrum.rossbyeigenfilename</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rossbyeigenfilename(; operators, V_symmetric, rotation_profile, modeltag = &quot;&quot;)</code></pre><p>Return the file name to which the results should be written. The output is a combination of the keyword arguments specifed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2957-L2962">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.FilteredEigenSingleOrder" href="#RossbyWaveSpectrum.FilteredEigenSingleOrder"><code>RossbyWaveSpectrum.FilteredEigenSingleOrder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredEigenSingleOrder</code></pre><p>Struct containing the filtered set of eigenvalues and eigenfunctions for a single <code>m</code>. A <code>FilteredEigenSingleOrder</code> is equivalent to a <code>Vector</code> of <code>serial =&gt; (eigenvalue, eigenfunction)</code> pairs, with additional metadata stored along with this. Indexing into a <code>FilteredEigenSingleOrder</code> with a serial number should return a <code>(eigenvalue, eigenfunction)</code> pair.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L133-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.colatitude_grid" href="#RossbyWaveSpectrum.colatitude_grid"><code>RossbyWaveSpectrum.colatitude_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">colatitude_grid(m::Integer, operators)</code></pre><p>Return the colatitude <span>$\left(\theta\right)$</span> grid that is used to compute eigenfunctions in real space for the specific azimuthal order <code>m</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L3094-L3099">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_MVcache" href="#RossbyWaveSpectrum.allocate_MVcache"><code>RossbyWaveSpectrum.allocate_MVcache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_MVcache(nrows)</code></pre><p>Allocate temporary matrices that are used to compute matrix products in-place. These are used in filtering the solutions (See <a href="#RossbyWaveSpectrum.Filters.EIGEN"><code>Filters.EIGEN</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2571-L2576">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RossbyWaveSpectrum.allocate_BCcache" href="#RossbyWaveSpectrum.allocate_BCcache"><code>RossbyWaveSpectrum.allocate_BCcache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allocate_BCcache(nrows)</code></pre><p>Allocate temporary matrices that are used to compute matrix products in-place. These are used in filtering the solutions (See <a href="#RossbyWaveSpectrum.Filters.BC"><code>Filters.BC</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/79d118c293453ede22a0d546bb15a4ca159b7e02/src/RossbyWaveSpectrum.jl#L2582-L2587">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Using the code</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 25 January 2024 06:47">Thursday 25 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
