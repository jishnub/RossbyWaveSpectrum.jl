<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · RossbyWaveSpectrum</title><meta name="title" content="Theory · RossbyWaveSpectrum"/><meta property="og:title" content="Theory · RossbyWaveSpectrum"/><meta property="twitter:title" content="Theory · RossbyWaveSpectrum"/><meta name="description" content="Documentation for RossbyWaveSpectrum."/><meta property="og:description" content="Documentation for RossbyWaveSpectrum."/><meta property="twitter:description" content="Documentation for RossbyWaveSpectrum."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>RossbyWaveSpectrum</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Theory</a><ul class="internal"><li><a class="tocitem" href="#Equations"><span>Equations</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li></ul></li><li><a class="tocitem" href="../">Using the code</a></li><li><a class="tocitem" href="../API/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jishnub/RossbyWaveSpectrum.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jishnub/RossbyWaveSpectrum.jl/blob/master/docs/src/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h1><h2 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h2><p>We solve the linearized Navier-Stokes equation in the anelastic approximation in a tracking frame that rotates at <span>$\Omega_0 \hat{z}$</span>. We represent the unperturbed zero-order profiles of background density by <span>$\bar{\rho}$</span>, pressure by <span>$\bar{p}$</span>, temperature by <span>$\bar{T}$</span>, gravity by <span>$\mathbf{g}$</span> and entropy by <span>$S_0$</span>. We denote perturbatations to these quantities using primes as superscripts. We define the velocity <span>$\mathbf{u}=\mathbf{u}_f + \mathbf{u}_\Omega$</span>, where <span>$\mathbf{u}_f$</span> is the velocity associated with the waves, and <span>$\mathbf{u}_\Omega$</span> is that for the differentially rotating background. We also represent the perturbation in the background entropy by <span>$S^\prime$</span>.</p><p>This leads to the following equations:</p><p class="math-container">\[\begin{align*}
\nabla\cdot\mathbf{u}_f&amp;=0\\
\partial_{t}\mathbf{u}_f&amp;=\mathbf{u}\times\boldsymbol{\nabla}\times\mathbf{u}-2\boldsymbol{\Omega}\times\mathbf{u}_f-\boldsymbol{\nabla}\left(\frac{p^{\prime}}{\bar{\rho}}+\frac{1}{2}\mathbf{u}^{2}\right)-\frac{S^{\prime}}{c_{p}}\mathbf{g}+\frac{1}{\bar{\rho}}\mathbf{F}_{\nu},\\
\partial_{t}S^{\prime}&amp;=-im\Delta\Omega S^{\prime}-\left(\mathbf{u}_f\cdot\boldsymbol{\nabla}\right)S_{0}+\kappa\frac{1}{\bar{\rho}\bar{T}}\boldsymbol{\nabla}\cdot\left(\bar{\rho}\bar{T}\boldsymbol{\nabla} S^{\prime}\right)
\end{align*}\]</p><p>Here, <span>$c_{p}$</span> is the specific heat at constant pressure, and <span>$\mathbf{F}_{\nu}$</span> is the viscous force.</p><p>We may expand the velocity in terms of stream functions as</p><p class="math-container">\[\begin{align*}
\bar{\rho}\mathbf{u}_f &amp;= \boldsymbol{\nabla}\times\boldsymbol{\nabla}\times\left(\bar{\rho}\,W\left(\mathbf{x}\right)\hat{r}\right)+\boldsymbol{\nabla}\times\left(\bar{\rho}\,V\left(\mathbf{x}\right)\hat{r}\right).
\end{align*}\]</p><p>This form of the velocity automatically satisfies the mass-conservation constraint. We expand the individual stream functions in a Chebyshev-spherical harmonic basis as</p><p class="math-container">\[\begin{align*}V\left(\mathbf{x}\right) &amp; =\sum_{n\ell m}V_{n\ell m}T_{n}\left(\hat{r}\right)\hat{P}_{\ell m}\left(\cos\theta\right)\exp\left(im\phi\right),\\
W\left(\mathbf{x}\right) &amp; =\sum_{n\ell m}W_{n\ell m}T_{n}\left(\hat{r}\right)\hat{P}_{\ell m}\left(\cos\theta\right)\exp\left(im\phi\right),\\
S^{\prime}\left(\mathbf{x}\right) &amp; =\sum_{n\ell m}S_{n\ell m}^{\prime}T_{n}\left(\hat{r}\right)\hat{P}_{\ell m}\left(\cos\theta\right)\exp\left(im\phi\right),
\end{align*}\]</p><p>where <span>$\hat{r}$</span> is a scaled radial coordinate that maps the radial domain to <span>$[-1,1]$</span>, and <span>$\hat{P}_{\ell m}\left(\cos\theta\right)$</span> represents the normalized associated Legendre polynomial of degree <span>$\ell$</span> and azimuthal order <span>$m$</span>. We note that owing to azimuthal symmetry of the background, the equations decouple in the azimuthal order <span>$m$</span>, and may be solved independently for each <span>$m$</span>. We may collectively express the coefficients <span>$V_{n\ell m}$</span> for a given <span>$m$</span> as <span>$\boldsymbol{V}_m$</span>, and similarly for the other fields. In the following section, we suppress the subscript <span>$m$</span> for brevity.</p><p>Substituting, and transforming to temporal frequency space, we may rewrite the equations in the form</p><p class="math-container">\[\left(\begin{array}{ccc}
A_{VV} &amp; A_{VW} &amp; A_{VS}\\
A_{WV} &amp; A_{WW} &amp; A_{WS}\\
A_{SV} &amp; A_{SW} &amp; A_{SS}
\end{array}\right)
\left(\begin{array}{c}
\boldsymbol{V}\\
\boldsymbol{W}\\
\boldsymbol{S}
\end{array}\right)=
\frac{\omega}{\Omega_0}
\left(\begin{array}{ccc}
B_{VV} &amp; 0 &amp; 0\\
0 &amp; B_{WW} &amp; 0\\
0 &amp; 0 &amp; B_{SS}
\end{array}\right)
\left(\begin{array}{c}
\boldsymbol{V}\\
\boldsymbol{W}\\
\boldsymbol{S}
\end{array}\right)\]</p><p>where each matrix element represents an operator — potentially a differential one. We may express this in a condensed form as</p><p class="math-container">\[A \mathbf{v} = \frac{\omega}{\Omega_0} B \mathbf{v},\]</p><p>where <span>$\mathbf{v}$</span> now collects all the coefficients, and represents the eigenfunction that we want to solve for.</p><p>We impose the boundary conditions</p><p class="math-container">\[ u_{r} = \partial_{r}\left(\frac{u_{\theta}}{r}\right)=\partial_{r}\left(\frac{u_{\phi}}{r}\right)=\partial_r S^\prime=0,\quad\text{on}\;r=r_{i},\quad\text{and}\;r=r_{o}.\]</p><p>and use the standard spherical-harmonic boundary conditions at the poles. These conditions may be translated to the spectral coefficients to obtain sets of equations of the form</p><p class="math-container">\[\left(\begin{array}{ccc}
C_{VV} &amp; 0 &amp; 0\\
0 &amp; C_{WW} &amp; 0\\
0 &amp; 0 &amp; C_{SS}
\end{array}\right)\left(\begin{array}{c}
\boldsymbol{V}\\
\boldsymbol{W}\\
\boldsymbol{S}
\end{array}\right)	=\left(\begin{array}{c}
\boldsymbol{0}\\
\boldsymbol{0}\\
\boldsymbol{0}
\end{array}\right)\]</p><p>We may express this in a condensed form as</p><p class="math-container">\[C \mathbf{v} = 0.\]</p><p>This tells us that the eigenfunction <span>$\mathbf{v}$</span> lies in the null-space of <span>$C$</span>. We transform from the radial Chebyshev basis to a different one that satisfies the radial boundary conditions. If we collect the basis elements as the columns of a matrix <span>$Z$</span>, we obtain <span>$CZ=0$</span> by construction. We may therefore express the eigenfunction as</p><p class="math-container">\[\mathbf{v} = Z \mathbf{w}.\]</p><p>Substituting this into the eigenvalue problem, and multiplying both sides by <span>$Z^T$</span>, we obtain</p><p class="math-container">\[\left(Z^T A Z\right) \mathbf{w} = \frac{\omega}{\Omega_0} \left(Z^T B Z\right) \mathbf{w},\]</p><p>which is now unconstrained in <span>$\mathbf{w}$</span>. We solve the eigenvalue problem to obtain solutions <span>$(\omega, \mathbf{w})$</span>, and subsequently project the eigenfunctions back to the Chebyshev basis to obtain <span>$(\omega, \mathbf{v}=Z\mathbf{w})$</span>.</p><p>We note that solutions to <span>$A \mathbf{v} = (\omega/\Omega_0) B \mathbf{v}$</span> must necessarily satisfy <span>$\left(Z^T A Z\right) \mathbf{w} = (\omega/\Omega_0) \left(Z^T B Z\right) \mathbf{w}$</span>, but the projected problem may produce solutions that do not satisfy the original system. We therefore include a post-processing step to filter out such solutions. We also filter out solutions that are not smooth, as well as exponentially growing ones.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><p>Bhattacharya, J., &amp; Hanasoge, S. M. 2023, ApJS, 264, 21, doi: <a href="https://iopscience.iop.org/article/10.3847/1538-4365/aca09a">10.3847/1538-4365/aca09a</a>. Preprint available at the <a href="https://arxiv.org/abs/2211.03323">Arxiv link</a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="../">Using the code »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 25 January 2024 06:47">Thursday 25 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
